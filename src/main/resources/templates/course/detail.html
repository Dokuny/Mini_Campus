<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{commons/layout}">
	
	<head>
		<title th:text="${course.subject}"></title>
		<script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
		<script>
			
			$(document).ready(function () {
				$('.submitBtn').on('click', function () {
					if (!confirm('수강신청을 하시겠습니까?')) {
						return false;
					}
					
					let $input = $('#courseId');
					
					let url = '/api/course/req.api';
					let parameter = {
						courseId: $input.val()
					};
					
					axios.post(url, parameter)
						.then(response => {
							if (response.data.result == false) {
								alert(response.data.message);
							} else {
								alert('수강신청 되었습니다.');
								location.href = '/';
							}
							
						}).catch(err => {
						alert('수강신청 실패했습니다.');
						
					})
					
				});
			});
		</script>
	</head>
	
	
	<th:block layout:fragment="content">
		<div class="container-fluid">
			<div class="card mb-3">
				<h3 class="card-header" th:text="${course.subject}">Card header</h3>
				<div class="card-body">
					<h6 class="card-subtitle text-muted">강의자</h6>
				</div>
				<svg xmlns="http://www.w3.org/2000/svg" class="d-block user-select-none" width="100%" height="200"
				     aria-label="Placeholder: Image cap" focusable="false" role="img"
				     preserveAspectRatio="xMidYMid slice" viewBox="0 0 318 180"
				     style="font-size:1.125rem;text-anchor:middle">
					<rect width="100%" height="100%" fill="#868e96"></rect>
					<text x="50%" y="50%" fill="#dee2e6" dy=".3em">Image cap</text>
				</svg>
				<div class="card-body" th:utext="${course.contents}">
				
				</div>
				<ul class="list-group list-group-flush">
					<li class="list-group-item">Cras justo odio</li>
					<li class="list-group-item">Dapibus ac facilisis in</li>
					<li class="list-group-item">Vestibulum at eros</li>
				</ul>
				<div class="card-body" sec:authorize="isAuthenticated()">
					<input type="hidden" id="courseId" name="courseId" th:value="${course.id}">
					<button type="submit" class="btn btn-success submitBtn">수강신청</button>
				</div>
				<div class="card-footer text-muted">
					2 days ago
				</div>
			</div>
		
		</div>
	</th:block>
</html>